<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API ç®¡ç†é¢æ¿</title>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Sora:wght@400;600;700&display=swap");

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --sidebar-bg: #0f172a;
      --sidebar-active: rgba(148, 163, 184, 0.18);
      --main-bg: #0b1020;
      --card-bg: #0f172a;
      --card-soft: #111b33;
      --text-primary: #e2e8f0;
      --text-secondary: #94a3b8;
      --accent-blue: #38bdf8;
      --accent-green: #34d399;
      --accent-red: #fb7185;
      --accent-orange: #f59e0b;
      --accent-purple: #a78bfa;
      --border-color: rgba(148, 163, 184, 0.15);
    }

    body {
      font-family: "Manrope", "Noto Sans SC", sans-serif;
      background: radial-gradient(1200px 600px at 10% -10%, rgba(56, 189, 248, 0.15), transparent 60%),
        radial-gradient(900px 500px at 90% 0%, rgba(167, 139, 250, 0.18), transparent 55%),
        #0b1020;
      color: var(--text-primary);
      display: flex;
      min-height: 100vh;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: repeating-linear-gradient(120deg, rgba(148, 163, 184, 0.03) 0 1px, transparent 1px 120px);
      pointer-events: none;
      z-index: 0;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 260px;
      background: linear-gradient(180deg, rgba(15, 23, 42, 0.95), rgba(10, 15, 30, 0.98));
      color: white;
      display: flex;
      flex-direction: column;
      padding: 20px 0;
      position: fixed;
      height: 100vh;
      z-index: 100;
      border-right: 1px solid rgba(148, 163, 184, 0.12);
      backdrop-filter: blur(10px);
    }

    .sidebar-header {
      padding: 0 20px 30px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .sidebar-header .logo {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, #38bdf8, #a78bfa);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .sidebar-header .title {
      font-size: 1.25rem;
      font-weight: 700;
      letter-spacing: 0.5px;
    }

    .sidebar-menu {
      flex: 1;
      list-style: none;
      padding: 0 12px;
    }

    .sidebar-item {
      margin-bottom: 4px;
    }

    .sidebar-link {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      color: rgba(226, 232, 240, 0.7);
      text-decoration: none;
      border-radius: 8px;
      font-size: 0.95rem;
      transition: all 0.2s;
    }

    .sidebar-link:hover {
      background: rgba(148, 163, 184, 0.12);
      color: white;
    }

    .sidebar-link.active {
      background: var(--sidebar-active);
      color: white;
    }

    .sidebar-footer {
      padding: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .sidebar-footer-stats {
      background: rgba(15, 23, 42, 0.6);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .footer-stat-item {
      display: flex;
      justify-content: space-between;
      font-size: 0.85rem;
      margin-bottom: 8px;
    }

    .footer-stat-item:last-child {
      margin-bottom: 0;
    }

    .footer-stat-label {
      color: rgba(255, 255, 255, 0.5);
    }

    .footer-stat-value.normal {
      color: #2ecc71;
    }

    .footer-stat-value.abnormal {
      color: #e74c3c;
    }

    .buy-button {
      background: linear-gradient(90deg, #38bdf8, #a78bfa);
      color: white;
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      text-decoration: none;
      display: block;
      font-weight: 600;
      margin-bottom: 20px;
    }

    /* Main Content Styles */
    .main-content {
      flex: 1;
      margin-left: 260px;
      padding: 28px 44px 40px;
      position: relative;
      z-index: 1;
      animation: fadeUp 0.45s ease;
    }

    .header-section {
      margin-bottom: 32px;
    }

    .header-section h1 {
      font-family: "Sora", "Noto Sans SC", sans-serif;
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .header-section p {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(12px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Grid Layouts */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 24px;
      margin-bottom: 32px;
    }

    @media (max-width: 1400px) {
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .stat-card {
      background: linear-gradient(160deg, rgba(15, 23, 42, 0.98), rgba(17, 27, 51, 0.98));
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 16px 30px rgba(3, 7, 18, 0.3);
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      border: 1px solid rgba(148, 163, 184, 0.12);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 36px rgba(2, 6, 23, 0.45);
    }

    .stat-info .label {
      font-size: 0.85rem;
      color: var(--text-secondary);
      font-weight: 600;
      margin-bottom: 8px;
      display: block;
    }

    .stat-info .value {
      font-size: 1.75rem;
      font-weight: 700;
    }

    .stat-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
    }

    .stat-icon.total {
      background: rgba(56, 189, 248, 0.18);
      color: #38bdf8;
    }

    .stat-icon.normal {
      background: rgba(52, 211, 153, 0.18);
      color: #34d399;
    }

    .stat-icon.abnormal {
      background: rgba(251, 113, 133, 0.18);
      color: #fb7185;
    }

    .stat-icon.selected {
      background: rgba(167, 139, 250, 0.18);
      color: #a78bfa;
    }

    /* Toolbar and Filter */
    .toolbar {
      background: rgba(15, 23, 42, 0.9);
      padding: 12px 16px;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      border: 1px solid rgba(148, 163, 184, 0.12);
      box-shadow: 0 10px 20px rgba(2, 6, 23, 0.35);
      gap: 16px;
    }

    .filter-tabs {
      display: flex;
      flex-wrap: wrap;
      background: rgba(15, 23, 42, 0.65);
      padding: 6px;
      border-radius: 10px;
      gap: 6px;
    }

    .tab-item {
      padding: 6px 14px;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
      color: #cbd5f5;
      background: transparent;
    }

    .tab-item.active {
      background: linear-gradient(90deg, rgba(56, 189, 248, 0.9), rgba(167, 139, 250, 0.9));
      color: white;
    }

    .tab-item:not(.active):hover {
      background: rgba(148, 163, 184, 0.2);
    }

    .action-buttons {
      display: flex;
      gap: 12px;
    }

    .btn {
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      border: 1px solid transparent;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-outline {
      background: rgba(15, 23, 42, 0.6);
      border-color: rgba(148, 163, 184, 0.25);
      color: #cbd5f5;
    }

    .btn-outline:hover {
      background: rgba(148, 163, 184, 0.18);
    }

    .btn-danger-outline {
      background: rgba(15, 23, 42, 0.6);
      border-color: rgba(251, 113, 133, 0.45);
      color: #fb7185;
    }

    .btn-primary {
      background: linear-gradient(90deg, #38bdf8, #a78bfa);
      color: white;
    }

    /* Content Area */
    .content-card {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 20px 30px rgba(2, 6, 23, 0.45);
      min-height: 400px;
      border: 1px solid rgba(148, 163, 184, 0.12);
    }

    .table-wrap {
      width: 100%;
      overflow: auto;
    }

    .table-wrap::-webkit-scrollbar {
      height: 10px;
    }

    .table-wrap::-webkit-scrollbar-thumb {
      background: rgba(148, 163, 184, 0.25);
      border-radius: 999px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 1100px;
    }

    th {
      padding: 14px 20px;
      text-align: left;
      font-size: 0.85rem;
      color: #94a3b8;
      font-weight: 600;
      border-bottom: 1px solid var(--border-color);
      position: sticky;
      top: 0;
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(6px);
    }

    td {
      padding: 12px 20px;
      border-bottom: 1px solid var(--border-color);
      font-size: 0.9rem;
      color: #cbd5f5;
    }

    thead {
      background: rgba(15, 23, 42, 0.9);
    }

    tr:last-child td {
      border-bottom: none;
    }

    tr:hover {
      background: rgba(148, 163, 184, 0.06);
    }

    .empty-state {
      background: radial-gradient(400px 200px at 20% 0%, rgba(56, 189, 248, 0.12), transparent 60%),
        rgba(15, 23, 42, 0.8);
      border: 1px dashed rgba(148, 163, 184, 0.3);
      border-radius: 18px;
      padding: 24px;
      margin: 16px;
    }

    /* Modal and Overlay */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(2, 6, 23, 0.65);
      backdrop-filter: blur(6px);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background: rgba(15, 23, 42, 0.98);
      border-radius: 18px;
      padding: 28px;
      width: 100%;
      max-width: 520px;
      box-shadow: 0 30px 60px rgba(2, 6, 23, 0.5);
      border: 1px solid rgba(148, 163, 184, 0.18);
    }

    .form-input {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid rgba(148, 163, 184, 0.2);
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.7);
      color: #e2e8f0;
      margin-top: 6px;
    }

    /* Toast */
    .toast-container {
      position: fixed;
      bottom: 24px;
      right: 24px;
      z-index: 2000;
    }

    .toast {
      background: rgba(15, 23, 42, 0.92);
      padding: 12px 24px;
      border-radius: 12px;
      box-shadow: 0 10px 15px -3px rgba(2, 6, 23, 0.6);
      margin-top: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }

      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @media (max-width: 1200px) {
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 900px) {
      body {
        flex-direction: column;
        overflow-x: hidden;
      }

      .sidebar {
        position: relative;
        width: 100%;
        height: auto;
      }

      .main-content {
        margin-left: 0;
        padding: 20px;
        width: 100%;
      }

      .toolbar {
        flex-direction: column;
        align-items: flex-start;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .table-wrap {
        overflow-x: auto;
      }
    }

    .config-section {
      padding-top: 8px;
    }

    .form-label {
      display: block;
      font-size: 0.85rem;
      font-weight: 500;
      color: #94a3b8;
      margin-bottom: 8px;
    }

    .form-input {
      width: 100%;
      padding: 10px 14px;
      border-radius: 8px;
      border: 1px solid rgba(148, 163, 184, 0.2);
      font-size: 0.95rem;
      color: #e2e8f0;
      background: rgba(15, 23, 42, 0.7);
      transition: all 0.2s;
    }

    .form-input:focus {
      outline: none;
      border-color: #38bdf8;
      box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.2);
    }

    .btn-icon {
      background: none;
      border: none;
      padding: 4px;
      cursor: pointer;
      color: #94a3b8;
      transition: color 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-icon:hover {
      color: #e2e8f0;
    }

    .platform-tabs {
      display: flex;
      gap: 12px;
      margin-bottom: 24px;
    }

    .platform-tabs .tab-item {
      background: rgba(15, 23, 42, 0.7);
      color: #cbd5f5;
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.2s;
    }

    .platform-tabs .tab-item:hover {
      background: rgba(148, 163, 184, 0.2);
    }

    .platform-tabs .tab-item.active {
      background: linear-gradient(90deg, rgba(56, 189, 248, 0.9), rgba(167, 139, 250, 0.9));
      color: #fff;
    }

    /* Config & Models Panel Overrides */
    #keysWrapper,
    #modelsWrapper {
      background: transparent !important;
      color: #e2e8f0;
    }

    #keysWrapper h2,
    #modelsWrapper h2 {
      color: #e2e8f0 !important;
    }

    #keysWrapper p,
    #modelsWrapper p,
    #keysWrapper small,
    #modelsWrapper small {
      color: #94a3b8 !important;
    }

    #keysWrapper .content-card,
    #modelsWrapper .content-card {
      background: rgba(15, 23, 42, 0.9) !important;
      border: 1px solid rgba(148, 163, 184, 0.12) !important;
      box-shadow: 0 20px 30px rgba(2, 6, 23, 0.45) !important;
    }

    #keysWrapper .platform-tabs .tab-item,
    #modelsWrapper .platform-tabs .tab-item {
      background: rgba(15, 23, 42, 0.7);
      color: #cbd5f5;
    }

    #keysWrapper .platform-tabs .tab-item.active,
    #modelsWrapper .platform-tabs .tab-item.active {
      background: linear-gradient(90deg, rgba(56, 189, 248, 0.9), rgba(167, 139, 250, 0.9));
      color: #fff;
    }

    #configTabs {
      border-bottom: 1px solid rgba(148, 163, 184, 0.12) !important;
    }

    #modelPlatformFilters {
      background: rgba(15, 23, 42, 0.7) !important;
      border: 1px solid rgba(148, 163, 184, 0.12) !important;
    }

    #keysWrapper .key-display {
      background: rgba(15, 23, 42, 0.7) !important;
      border-color: rgba(148, 163, 184, 0.3) !important;
      color: #cbd5f5;
    }

    #keysWrapper .form-input,
    #modelsWrapper .form-input {
      background: rgba(15, 23, 42, 0.7) !important;
      border-color: rgba(148, 163, 184, 0.2) !important;
      color: #e2e8f0 !important;
    }

    #keysWrapper .form-input::placeholder,
    #modelsWrapper .form-input::placeholder {
      color: rgba(148, 163, 184, 0.6);
    }

    /* Toggle Switch Refinement */
    .toggle {
      display: inline-flex;
      align-items: center;
      cursor: pointer;
      user-select: none;
    }

    .toggle input {
      display: none;
    }

    .toggle-slider {
      position: relative;
      width: 40px;
      height: 22px;
      background-color: #e2e8f0;
      border-radius: 20px;
      transition: 0.3s;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      border-radius: 50%;
      transition: 0.3s;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .toggle input:checked+.toggle-slider {
      background-color: #10b981;
    }

    .toggle input:checked+.toggle-slider:before {
      transform: translateX(18px);
    }

    /* Account Table Styles */
    .usage-progress-container {
      width: 100px;
      height: 6px;
      background: #f1f5f9;
      border-radius: 3px;
      overflow: hidden;
      margin-right: 8px;
    }

    .usage-progress-bar {
      height: 100%;
      border-radius: 3px;
      transition: width 0.3s ease;
    }

    .usage-progress-bar.green {
      background: #10b981;
    }

    .usage-progress-bar.orange {
      background: #f59e0b;
    }

    .usage-progress-bar.red {
      background: #ef4444;
    }

    .tag {
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
      display: inline-block;
    }

    .tag-free {
      background: rgba(52, 211, 153, 0.16);
      color: #34d399;
      border: 1px solid rgba(52, 211, 153, 0.3);
    }

    .tag-status-normal {
      background: rgba(52, 211, 153, 0.16);
      color: #34d399;
      font-size: 0.7rem;
      padding: 4px 6px;
      line-height: 1.2;
      text-align: center;
      width: 32px;
    }

    .action-icon {
      cursor: pointer;
      color: #94a3b8;
      transition: color 0.2s;
      font-size: 1.1rem;
    }

    .action-icon:hover {
      color: #e2e8f0;
    }

    .token-text {
      font-family: monospace;
      color: #94a3b8;
      font-size: 0.85rem;
      max-width: 200px;
      display: inline-block;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* Platform Badges */
    .badge-kiro {
      background: #e0f2fe;
      color: #0369a1;
    }

    .badge-orchids {
      background: #f5f3ff;
      color: #7c3aed;
    }

    .badge-antigravity {
      background: #f0fdf4;
      color: #16a34a;
    }

    .badge-warp {
      background: #eef2ff;
      color: #4f46e5;
    }

    .status-badge {
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .status-enabled {
      background: #ecfdf4;
      color: #15803d;
    }

    .default-check {
      color: #10b981;
      font-size: 1.1rem;
    }

    .set-default-link {
      color: #3b82f6;
      text-decoration: none;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .set-default-link:hover {
      text-decoration: underline;
    }

    .tab-kiro.active {
      background: #3b82f6 !important;
    }

    .tab-orchids.active {
      background: #8b5cf6 !important;
    }

    .tab-antigravity.active {
      background: #10b981 !important;
    }

    .tab-warp.active {
      background: #6366f1 !important;
    }
  </style>
</head>

<body>
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">C</div>
      <div class="title">CodeFreeMax</div>
    </div>
    <ul class="sidebar-menu">
      <li class="sidebar-item">
        <a href="#" class="sidebar-link active" onclick="switchTab('accounts')">
          <span>ğŸ‘¤</span> è´¦å·ç®¡ç†
        </a>
      </li>
      <li class="sidebar-item">
        <a href="#" class="sidebar-link" onclick="switchTab('keys')">
          <span>âš™ï¸</span> é…ç½®ç®¡ç†
        </a>
      </li>
      <li class="sidebar-item">
        <a href="#" class="sidebar-link" onclick="switchTab('models')">
          <span>ğŸ“</span> æ¨¡å‹ç®¡ç†
        </a>
      </li>
      <li class="sidebar-item">
        <a href="#" class="sidebar-link" onclick="switchTab('qa')">
          <span>ğŸ§ª</span> è´¨é‡æµ‹è¯•
        </a>
      </li>
      <li class="sidebar-item">
        <a href="#" class="sidebar-link">
          <span>ğŸ“–</span> ä½¿ç”¨æ•™ç¨‹
        </a>
      </li>
      <li class="sidebar-item">
        <a href="#" class="sidebar-link">
          <span>ğŸ’¬</span> è”ç³»å¼€å‘è€…
        </a>
      </li>
    </ul>
    <div style="padding: 0 12px; margin-bottom: 20px;">
      <a href="#" class="buy-button">ğŸ›’ æ¸ é“è´¦å·è´­ä¹°</a>
    </div>
    <div class="sidebar-footer">
      <div class="sidebar-footer-stats">
        <div class="footer-stat-item">
          <span class="footer-stat-label">æ€»è´¦å·</span>
          <span class="footer-stat-value" id="footerTotal">0</span>
        </div>
        <div class="footer-stat-item">
          <span class="footer-stat-label">æ­£å¸¸</span>
          <span class="footer-stat-value normal" id="footerNormal">0</span>
        </div>
        <div class="footer-stat-item">
          <span class="footer-stat-label">å¼‚å¸¸</span>
          <span class="footer-stat-value abnormal" id="footerAbnormal">0</span>
        </div>
      </div>
      <div style="font-size: 0.8rem; color: rgba(255,255,255,0.4);">
        ä»Šæ—¥ç”¨é‡ <span style="float: right;">4/10000</span>
        <div style="height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; margin: 8px 0;">
          <div id="usageProgress" style="width: 1%; background: #3b82f6; height: 100%; border-radius: 2px;"></div>
        </div>
      </div>
      <div
        style="display: flex; justify-content: space-between; align-items: center; margin-top: 16px; font-size: 0.75rem; color: rgba(255,255,255,0.3);">
        <span>æˆæƒåˆ°æœŸ</span>
        <span id="expiryDate">2026/02/24</span>
      </div>
      <div
        style="display: flex; justify-content: space-between; align-items: center; margin-top: 4px; font-size: 0.75rem; color: rgba(255,255,255,0.3);">
        <span>GitHub</span>
        <span>v2.4.5</span>
      </div>
      <button class="btn"
        style="width: 100%; margin-top: 16px; background: rgba(255,255,255,0.05); color: white; justify-content: center;"
        onclick="logout()">
        ğŸšª é€€å‡ºç™»å½•
      </button>
    </div>
  </aside>

  <main class="main-content">
    <section class="header-section" id="accountsHeader">
      <h1 id="pageTitle">è´¦å·ç®¡ç†</h1>
      <p id="pageSubtitle">ç®¡ç†æ‚¨çš„ Orchids API å‡­è¯</p>
    </section>

    <div id="accountsWrapper">
      <section class="stats-grid" id="statsGrid">
        <div class="stat-card">
          <div class="stat-info">
            <span class="label">æ€»è´¦å·æ•°</span>
            <span class="value" id="totalAccounts">0</span>
          </div>
          <div class="stat-icon total">ğŸ‘¥</div>
        </div>
        <div class="stat-card">
          <div class="stat-info">
            <span class="label">çŠ¶æ€æ­£å¸¸</span>
            <span class="value" style="color: #10b981" id="enabledAccounts">0</span>
          </div>
          <div class="stat-icon normal">âœ…</div>
        </div>
        <div class="stat-card">
          <div class="stat-info">
            <span class="label">çŠ¶æ€å¼‚å¸¸</span>
            <span class="value" style="color: #ef4444" id="disabledAccounts">0</span>
          </div>
          <div class="stat-icon abnormal">âš ï¸</div>
        </div>
        <div class="stat-card">
          <div class="stat-info">
            <span class="label">å·²é€‰ä¸­</span>
            <span class="value" style="color: #8b5cf6" id="selectedCount">0</span>
          </div>
          <div class="stat-icon selected">ğŸ“‹</div>
        </div>
      </section>

      <div id="accountsTabContent">
        <div class="toolbar" style="padding: 16px; gap: 16px; flex-wrap: wrap;">
          <div class="filter-tabs" id="platformFilters"></div>

          <div
            style="flex: 1; display: flex; gap: 12px; align-items: center; justify-content: flex-end; flex-wrap: wrap;">
            <div style="display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
              <button class="btn btn-outline" onclick="document.getElementById('importFile').click()">ğŸ“¤ å¯¼å…¥</button>
              <button class="btn btn-outline" onclick="exportAccounts()">ğŸ“¥ å¯¼å‡º</button>
              <input type="file" id="importFile" accept=".json" style="display: none"
                onchange="importAccounts(event)" />
              <button class="btn btn-outline" id="checkAllBtn" onclick="checkAllAccounts()">âœ… æ£€æµ‹è´¦å·</button>
              <label class="toggle"
                style="gap: 10px; padding: 6px 10px; border-radius: 10px; border: 1px solid rgba(148,163,184,0.2);">
                <input type="checkbox" id="autoCheckToggle" onchange="toggleAutoCheck(this.checked)" />
                <span class="toggle-slider"></span>
                <span style="font-size: 0.85rem; color: #cbd5f5;">è‡ªåŠ¨æ£€æµ‹</span>
              </label>
            </div>
            <div style="width: 1px; height: 24px; background: #e2e8f0; margin: 0 4px;"></div>
            <div style="display: flex; gap: 8px;">
              <button class="btn btn-outline" id="batchDeleteBtn" disabled onclick="batchDeleteAccounts()">ğŸ—‘ï¸
                æ‰¹é‡åˆ é™¤</button>
              <button class="btn btn-danger-outline" onclick="clearAbnormalAccounts()">ğŸ§¹ æ¸…ç©ºå¼‚å¸¸</button>
              <button class="btn btn-danger-outline" onclick="deleteAllAccounts()">ğŸ§¨ åˆ é™¤å…¨éƒ¨</button>
            </div>
            <button class="btn btn-primary" style="background: #3b82f6; border: none; padding: 8px 20px;"
              onclick="openModal()">+ æ·»åŠ è´¦å·</button>
          </div>
        </div>

        <div class="content-card">
          <div id="accountsList">
            <div class="empty-state"
              style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 300px; color: #94a3b8;">
              <span style="font-size: 3rem; margin-bottom: 16px;">ğŸ“‚</span>
              <p>æš‚æ— è´¦å·æ•°æ®</p>
            </div>
          </div>
        </div>

        <div
          style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px; color: var(--text-secondary); font-size: 0.9rem;">
          <div id="paginationInfo">å…± 0 æ¡è®°å½•ï¼Œç¬¬ 1/1 é¡µ</div>
          <div style="display: flex; gap: 12px; align-items: center;">
            <select class="form-input" style="width: auto; margin: 0;" onchange="updatePageSize(this.value)">
              <option value="20">20 æ¡/é¡µ</option>
              <option value="50">50 æ¡/é¡µ</option>
              <option value="100">100 æ¡/é¡µ</option>
            </select>
            <div style="display: flex; gap: 4px;" id="paginationControls">
              <button class="btn btn-outline" style="padding: 4px 10px;">é¦–é¡µ</button>
              <button class="btn btn-outline" style="padding: 4px 10px;">ä¸Šä¸€é¡µ</button>
              <button class="btn btn-primary"
                style="padding: 4px 10px; min-width: 32px; justify-content: center;">1</button>
              <button class="btn btn-outline" style="padding: 4px 10px;">ä¸‹ä¸€é¡µ</button>
              <button class="btn btn-outline" style="padding: 4px 10px;">æœ«é¡µ</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="keysWrapper" style="display: none; background: #f8fafc; padding: 24px; min-height: 100%;">
      <div style="margin-bottom: 32px;">
        <h2 style="font-size: 1.5rem; font-weight: 700; color: #1e293b; margin-bottom: 8px;">é…ç½®ç®¡ç†</h2>
        <p style="color: #64748b; font-size: 0.95rem;">ç®¡ç†ç³»ç»ŸåŸºç¡€é…ç½®ã€è´Ÿè½½å‡è¡¡ã€æˆæƒç­‰è®¾ç½®</p>
      </div>

      <div class="content-card"
        style="padding: 24px; border-radius: 12px; border: 1px solid #e2e8f0; background: #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
        <div id="configTabs" class="platform-tabs" style="margin-bottom: 32px; border-bottom: 1px solid #f1f5f9;">
          <button class="tab-item active" onclick="switchConfigTab('basic')">åŸºç¡€é…ç½®</button>
          <button class="tab-item" onclick="switchConfigTab('auth')">æˆæƒé…ç½®</button>
          <button class="tab-item" onclick="switchConfigTab('proxy')">ä»£ç†é…ç½®</button>
        </div>

        <div id="basicConfig" class="config-section">
          <!-- ç®¡ç†å‘˜å¯†ç  -->
          <div style="margin-bottom: 32px;">
            <div style="font-weight: 600; font-size: 1rem; color: #1e293b; margin-bottom: 12px;">ç®¡ç†å‘˜å¯†ç </div>
            <div class="form-group" style="max-width: 800px;">
              <div style="position: relative;">
                <input type="password" class="form-input" id="cfg_admin_pass" placeholder="ç®¡ç†å‘˜å¯†ç "
                  style="padding-right: 48px; border-color: #e2e8f0; background: #fbfbfc;" />
                <div
                  style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); display: flex; gap: 8px;">
                  <button class="btn btn-icon" onclick="togglePassword('cfg_admin_pass')"><i
                      class="eye-icon">ğŸ‘ï¸</i></button>
                </div>
              </div>
              <small
                style="color: #64748b; margin-top: 8px; display: block; font-size: 0.85rem;">ç”¨äºç®¡ç†åå°ç™»å½•è®¤è¯ï¼Œä¿®æ”¹åéœ€è¦é‡æ–°ç™»å½•</small>
            </div>
          </div>

          <!-- APIå¯†é’¥ -->
          <div style="margin-bottom: 32px;">
            <div style="font-weight: 600; font-size: 1rem; color: #1e293b; margin-bottom: 12px;">APIå¯†é’¥</div>
            <div class="form-group" style="max-width: 800px;">
              <div style="position: relative;">
                <input type="password" class="form-input" id="cfg_admin_token" placeholder="ç•™ç©ºåˆ™ä¸å¯ç”¨è®¤è¯"
                  style="padding-right: 80px; border-color: #10b981; background: #fbfbfc;" />
                <div
                  style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); display: flex; gap: 8px;">
                  <button class="btn btn-icon" onclick="togglePassword('cfg_admin_token')">ğŸ‘ï¸</button>
                  <button class="btn btn-icon" onclick="copyFieldValue('cfg_admin_token')">ğŸ“‹</button>
                </div>
              </div>
              <small
                style="color: #64748b; margin-top: 8px; display: block; font-size: 0.85rem;">ç”¨äºAPIæ¥å£è®¤è¯ï¼Œç•™ç©ºåˆ™ä¸å¯ç”¨è®¤è¯</small>
            </div>
          </div>

          <!-- é‡è¯•é…ç½® -->
          <div style="margin-bottom: 32px;">
            <div style="font-weight: 600; font-size: 1rem; color: #1e293b; margin-bottom: 16px;">é‡è¯•é…ç½®</div>
            <div class="form-row"
              style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; max-width: 800px;">
              <div class="form-group">
                <label class="form-label">æœ€å¤§é‡è¯•æ¬¡æ•°</label>
                <input type="number" class="form-input" id="cfg_max_retries" value="3" style="background: #fbfbfc;" />
              </div>
              <div class="form-group">
                <label class="form-label">é‡è¯•å»¶è¿Ÿ(ms)</label>
                <input type="number" class="form-input" id="cfg_retry_delay" value="1000"
                  style="background: #fbfbfc;" />
              </div>
              <div class="form-group">
                <label class="form-label">å‡­è¯åˆ‡æ¢æ¬¡æ•°</label>
                <input type="number" class="form-input" id="cfg_switch_count" value="5" style="background: #fbfbfc;" />
              </div>
            </div>
            <small
              style="color: #64748b; margin-top: 12px; display: block; font-size: 0.85rem;">è¯·æ±‚å¤±è´¥åä¼šè‡ªåŠ¨é‡è¯•ï¼Œå¹¶å°è¯•åˆ‡æ¢ä¸åŒè´¦å·</small>
          </div>

          <!-- è¯·æ±‚é…ç½® -->
          <div style="margin-bottom: 32px;">
            <div style="font-weight: 600; font-size: 1rem; color: #1e293b; margin-bottom: 16px;">è¯·æ±‚é…ç½®</div>
            <div class="form-row"
              style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; max-width: 800px;">
              <div class="form-group">
                <label class="form-label">è¯·æ±‚è¶…æ—¶(ç§’)</label>
                <input type="number" class="form-input" id="cfg_request_timeout" value="120"
                  style="background: #fbfbfc;" />
              </div>
              <div class="form-group">
                <label class="form-label">Tokenåˆ·æ–°é—´éš”(åˆ†é’Ÿ)</label>
                <input type="number" class="form-input" id="cfg_refresh_interval" value="30"
                  style="background: #fbfbfc;" />
              </div>
            </div>
          </div>

          <!-- è‡ªåŠ¨åˆ·æ–°è®¾ç½® -->
          <div style="margin-bottom: 32px;">
            <div style="font-weight: 600; font-size: 1rem; color: #1e293b; margin-bottom: 16px;">è‡ªåŠ¨åˆ·æ–°è®¾ç½®</div>
            <div style="display: flex; flex-direction: column; gap: 24px;">
              <div>
                <label class="toggle" style="justify-content: flex-start; gap: 12px; margin-bottom: 8px;">
                  <input type="checkbox" id="cfg_auto_refresh_token" onchange="updateSwitchLabel(this, 'è‡ªåŠ¨åˆ·æ–°Token')" />
                  <span class="toggle-slider"></span>
                  <span id="label_cfg_auto_refresh_token" style="font-size: 0.95rem; color: #1e293b;">è‡ªåŠ¨åˆ·æ–°Token
                    (å·²å…³é—­)</span>
                </label>
                <small
                  style="color: #64748b; display: block; font-size: 0.85rem; margin-left: 52px;">å¼€å¯åï¼Œç³»ç»Ÿæ¯10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡å®šæ—¶ä»»åŠ¡ï¼Œä»…å½“Tokenæœ‰æ•ˆæœŸå‰©ä½™10åˆ†é’Ÿå†…æ‰ä¼šè§¦å‘åˆ·æ–°</small>
              </div>
              <div>
                <label class="toggle" style="justify-content: flex-start; gap: 12px; margin-bottom: 8px;">
                  <input type="checkbox" id="cfg_auto_refresh_usage" onchange="updateSwitchLabel(this, 'è‡ªåŠ¨åˆ·æ–°ç”¨é‡')" />
                  <span class="toggle-slider"></span>
                  <span id="label_cfg_auto_refresh_usage" style="font-size: 0.95rem; color: #1e293b;">è‡ªåŠ¨åˆ·æ–°ç”¨é‡
                    (å·²å…³é—­)</span>
                </label>
                <small
                  style="color: #64748b; display: block; font-size: 0.85rem; margin-left: 52px;">å¼€å¯åï¼Œç³»ç»Ÿæ¯10åˆ†é’Ÿå®šæ—¶åˆ·æ–°ä¸€æ¬¡è´¦å·ç”¨é‡ä¿¡æ¯</small>
              </div>
            </div>
          </div>

          <!-- Tokenè®¡æ•°è®¾ç½® -->
          <div style="margin-bottom: 32px;">
            <div style="font-weight: 600; font-size: 1rem; color: #1e293b; margin-bottom: 16px;">Tokenè®¡æ•°è®¾ç½®</div>
            <div style="display: flex; gap: 32px;">
              <label class="checkbox-container" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="checkbox" id="cfg_output_token_count" checked style="width: 18px; height: 18px;" />
                <span style="font-size: 0.95rem; color: #1e293b;">è¾“å‡ºTokenè®¡æ•°</span>
              </label>
              <label class="checkbox-container" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="checkbox" id="cfg_cache_token_count" checked style="width: 18px; height: 18px;" />
                <span style="font-size: 0.95rem; color: #1e293b;">ç¼“å­˜Tokenè®¡æ•°</span>
              </label>
            </div>
          </div>

          <!-- ç¼“å­˜é…ç½® -->
          <div style="margin-bottom: 40px;">
            <div style="font-weight: 600; font-size: 1rem; color: #1e293b; margin-bottom: 16px;">ç¼“å­˜é…ç½®</div>
            <div class="form-row"
              style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; max-width: 800px;">
              <div class="form-group">
                <label class="form-label">ç¼“å­˜æ—¶é—´ (TTL)</label>
                <select class="form-input" id="cfg_cache_ttl" style="background: #fbfbfc;">
                  <option value="5">5åˆ†é’Ÿ</option>
                  <option value="10">10åˆ†é’Ÿ</option>
                  <option value="30">30åˆ†é’Ÿ</option>
                  <option value="60">1å°æ—¶</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">ç¼“å­˜ç­–ç•¥</label>
                <select class="form-input" id="cfg_cache_strategy" style="background: #fbfbfc;">
                  <option value="split">åˆ†ç¦»ç¼“å­˜ (æ¨è)</option>
                  <option value="mixed">æ··åˆç¼“å­˜</option>
                </select>
              </div>
            </div>
          </div>

          <div style="display: flex; justify-content: flex-start;">
            <button class="btn btn-primary" onclick="saveConfiguration()"
              style="padding: 10px 48px; font-weight: 500;">ä¿å­˜é…ç½®</button>
          </div>
        </div>

        <div id="authConfig" class="config-section" style="display: none;">
          <div class="toolbar" style="margin-bottom: 24px">
            <h2 style="margin: 0; font-size: 1.1rem; font-weight: 600; color: #1e293b;">API Key ç®¡ç†</h2>
            <button class="btn btn-primary btn-sm" onclick="openCreateKeyModal()">+ åˆ›å»º API Key</button>
          </div>
          <div id="keysList"></div>
        </div>

        <div id="proxyConfig" class="config-section" style="display: none;">
          <div style="max-width: 800px;">
            <div style="margin-bottom: 24px;">
              <h2 style="font-size: 1.1rem; font-weight: 600; color: #1e293b; margin-bottom: 24px;">ä»£ç†æœåŠ¡å™¨é…ç½®</h2>

              <div class="form-group" style="margin-bottom: 24px;">
                <label class="form-label">HTTP ä»£ç†åœ°å€</label>
                <input type="text" class="form-input" id="cfg_proxy_http" placeholder="http://127.0.0.1:7890"
                  style="background: #fbfbfc;" />
              </div>

              <div class="form-group" style="margin-bottom: 24px;">
                <label class="form-label">HTTPS ä»£ç†åœ°å€</label>
                <input type="text" class="form-input" id="cfg_proxy_https" placeholder="http://127.0.0.1:7890"
                  style="background: #fbfbfc;" />
              </div>

              <div class="form-row"
                style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; margin-bottom: 24px;">
                <div class="form-group">
                  <label class="form-label">ç”¨æˆ·å (å¯é€‰)</label>
                  <input type="text" class="form-input" id="cfg_proxy_user" style="background: #fbfbfc;"
                    autocomplete="off" />
                </div>
                <div class="form-group">
                  <label class="form-label">å¯†ç  (å¯é€‰)</label>
                  <div style="position: relative;">
                    <input type="password" class="form-input" id="cfg_proxy_pass"
                      style="padding-right: 48px; background: #fbfbfc;" autocomplete="new-password" />
                    <div style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%);">
                      <button class="btn btn-icon" onclick="togglePassword('cfg_proxy_pass')">ğŸ‘ï¸</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-group" style="margin-bottom: 32px;">
                <label class="form-label">ä¸èµ°ä»£ç†çš„ä¸»æœº (æ¯è¡Œä¸€ä¸ª)</label>
                <textarea class="form-input" id="cfg_proxy_bypass" rows="4"
                  placeholder="localhost&#10;127.0.0.1&#10;*.example.com"
                  style="background: #fbfbfc; resize: vertical;"></textarea>
                <small
                  style="color: #64748b; margin-top: 8px; display: block; font-size: 0.85rem;">è¿™äº›åœ°å€å°†ç›´æ¥è¿æ¥ï¼Œç»•è¿‡ä»£ç†è®¾ç½®</small>
              </div>

              <button class="btn btn-primary" onclick="saveConfiguration()" style="padding: 10px 48px;">ä¿å­˜é…ç½®</button>
            </div>
          </div>
        </div>
      </div>
    </div>


    <!-- Models Wrapper -->
    <div id="modelsWrapper" style="display: none;">
      <section class="header-section" id="modelsHeader">
        <h1>æ¨¡å‹ç®¡ç†</h1>
        <p>ç®¡ç†å„æ¸ é“çš„å¯ç”¨æ¨¡å‹åˆ—è¡¨</p>
      </section>

      <div class="toolbar" style="padding: 16px; gap: 16px; flex-wrap: wrap;">
        <div class="filter-tabs" id="modelPlatformFilters">
          <button class="tab-item active" onclick="filterModelsByChannel('')">All</button>
          <button class="tab-item tab-orchids" onclick="filterModelsByChannel('Orchids')">Orchids</button>
        </div>

        <div
          style="display: flex; gap: 12px; align-items: center; justify-content: flex-end; flex-wrap: wrap; margin-left: auto;">
          å…± <strong id="totalModelCount">0</strong> ä¸ªæ¨¡å‹
        </div>
        <button class="btn btn-outline" onclick="refreshModels()">ğŸ”„ ä»ä¸Šæ¸¸åˆ·æ–°</button>
        <button class="btn btn-primary" style="background: #3b82f6; border: none; padding: 8px 20px;"
          onclick="openModelModal()">+ æ·»åŠ æ¨¡å‹</button>
      </div>
    </div>

    <div class="content-card">
      <div id="modelsList">
        <div class="empty-state"
          style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 300px; color: #94a3b8;">
          <span style="font-size: 3rem; margin-bottom: 16px;">ğŸ’</span>
          <p>æš‚æ— æ¨¡å‹æ•°æ®</p>
        </div>
      </div>
    </div>
    </div>
    </div>

    <!-- QA Tester Wrapper -->
    <div id="qaWrapper" style="display: none;">
      <section class="header-section" id="qaHeader">
        <h1>API è´¨é‡æµ‹è¯•</h1>
        <p>è¿è¡Œé¢„å®šä¹‰æµ‹è¯•ç”¨ä¾‹ä»¥éªŒè¯ API è¾“å‡ºè´¨é‡</p>
      </section>

      <div class="content-card" style="padding: 24px;">
        <div style="display: flex; gap: 16px; margin-bottom: 24px;">
          <div style="flex: 1;">
            <label class="form-label">æµ‹è¯•ç”¨ä¾‹</label>
            <select id="qaTestCase" class="form-input" onchange="loadQaPrompt()">
              <option value="greeting">Basic Greeting (åŸºç¡€é—®å€™)</option>
              <option value="math">Mathematical Reasoning (æ•°å­¦æ¨ç†/æ€è€ƒ)</option>
              <option value="tool_ls">Tool Use: ls (å·¥å…·è°ƒç”¨: ls)</option>
              <option value="tool_calc">Tool Use: calc (å·¥å…·: è®¡ç®—)</option>
              <option value="mega_context">Ultra-Long Context (è¶…é•¿ä¸Šä¸‹æ–‡ 50k+)</option>
              <option value="custom">Custom Input (è‡ªå®šä¹‰è¾“å…¥)</option>
            </select>
          </div>
          <div style="flex: 1;">
            <label class="form-label">æ¨¡å‹</label>
            <input type="text" id="qaModel" class="form-input" value="claude-3-5-sonnet-20241022" />
          </div>
          <div style="display: flex; align-items: flex-end;">
            <button class="btn btn-primary" onclick="runQaTest()" id="qaRunBtn">â–¶ è¿è¡Œæµ‹è¯•</button>
          </div>
        </div>

        <div style="margin-bottom: 24px;">
          <label class="form-label">Prompt Input</label>
          <textarea id="qaInput" class="form-input" rows="4"
            style="font-family: monospace;">Hello, say hi locally.</textarea>
        </div>

        <div>
          <label class="form-label">Output Log</label>
          <div id="qaOutput" style="
            background: #0f172a; 
            border: 1px solid rgba(148, 163, 184, 0.2); 
            border-radius: 8px; 
            padding: 16px; 
            height: 400px; 
            overflow-y: auto; 
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace; 
            font-size: 0.9rem; 
            color: #e2e8f0;
            white-space: pre-wrap;
          "></div>
        </div>
      </div>
    </div>

    <!-- Model Modal -->
    <div class="modal" id="modelModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="modelModalTitle">æ·»åŠ æ¨¡å‹</h3>
          <button class="modal-close" onclick="closeModelModal()">&times;</button>
        </div>
        <form id="modelForm" onsubmit="saveModel(event)">
          <input type="hidden" id="modelId" />
          <div class="form-group">
            <label class="form-label">æ¸ é“</label>
            <select class="form-input" id="modelChannel" style="background: #fbfbfc;">
              <option value="Orchids">Orchids</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">æ¨¡å‹ ID (Model ID)</label>
            <input type="text" class="form-input" id="modelModelId" required
              placeholder="e.g. claude-3-opus-20240229" />
          </div>
          <div class="form-group">
            <label class="form-label">æ˜¾ç¤ºåç§° (Name)</label>
            <input type="text" class="form-input" id="modelName" required placeholder="e.g. Claude 3 Opus" />
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">æ’åºæƒé‡</label>
              <input type="number" class="form-input" id="modelSortOrder" value="0" />
            </div>
            <div class="form-group">
              <label class="form-label">çŠ¶æ€</label>
              <select class="form-input" id="modelStatus" style="background: #fbfbfc;">
                <option value="available">å¯ç”¨ (Available)</option>
                <option value="maintenance">ç»´æŠ¤ (Maintenance)</option>
                <option value="offline">ä¸‹çº¿ (Offline)</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">
              <label class="toggle">
                <input type="checkbox" id="modelIsDefault" />
                <span class="toggle-slider"></span>
              </label>
              &nbsp;&nbsp;è®¾ä¸ºé»˜è®¤æ¨¡å‹
            </label>
          </div>
          <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 16px">
            ä¿å­˜
          </button>
        </form>
      </div>
    </div>

    <!-- åˆ›å»º Key å¼¹çª— -->
    <div class="modal" id="createKeyModal">
      <div class="modal-content" style="max-width: 450px;">
        <div class="modal-header">
          <h3 class="modal-title">åˆ›å»º API Key</h3>
          <button class="modal-close" onclick="closeCreateKeyModal()">
            &times;
          </button>
        </div>
        <form onsubmit="createApiKey(event)">
          <div class="form-group">
            <label class="form-label">åç§° / å¤‡æ³¨ï¼ˆæ”¯æŒæ¢è¡Œæ‰¹é‡åˆ›å»ºï¼‰</label>
            <textarea class="form-input" id="keyName" required placeholder="æ¯è¡Œä¸€ä¸ªåç§°ï¼Œä¾‹å¦‚ï¼š&#10;ç”Ÿäº§ç¯å¢ƒ&#10;æµ‹è¯•ç”¨&#10;å¼€å‘è€…-å¼ ä¸‰"
              rows="4" style="resize: vertical;"></textarea>
          </div>
          <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 16px;">
            åˆ›å»º
          </button>
        </form>
      </div>
    </div>

    <!-- Key å±•ç¤ºå¼¹çª— -->
    <div class="modal" id="showKeyModal">
      <div class="modal-content" style="max-width: 550px;">
        <div class="modal-header">
          <h3 class="modal-title">API Key å·²åˆ›å»º</h3>
        </div>
        <p style="color: #a1a1aa; margin-bottom: 16px;">
          è¯·ç«‹å³å¤åˆ¶å¹¶ä¿å­˜æ‚¨çš„ API Keyï¼š
        </p>
        <div id="fullKeyDisplay" style="max-height: 300px; overflow-y: auto;">
        </div>
        <div class="warning-box">
          <strong>è¯·å¦¥å–„ä¿å­˜</strong><br />
          å…³é—­æ­¤çª—å£åå°†æ— æ³•å†æ¬¡æŸ¥çœ‹å®Œæ•´ Key
        </div>
        <div style="display: flex; gap: 8px; margin-top: 20px;">
          <button class="btn btn-primary" style="flex: 1;" onclick="copyAllKeys()">
            å¤åˆ¶å…¨éƒ¨
          </button>
          <button class="btn" style="flex: 1; background: rgba(255,255,255,0.1); color: white;"
            onclick="closeShowKeyModal()">
            æˆ‘å·²ä¿å­˜ï¼Œå…³é—­
          </button>
        </div>
      </div>
    </div>

    <!-- åˆ é™¤ Key ç¡®è®¤å¼¹çª— -->
    <div class="modal" id="deleteKeyModal">
      <div class="modal-content" style="max-width: 400px;">
        <div class="modal-header">
          <h3 class="modal-title">åˆ é™¤ API Key</h3>
          <button class="modal-close" onclick="closeDeleteKeyModal()">
            &times;
          </button>
        </div>
        <p style="margin-bottom: 20px;">
          ç¡®å®šè¦åˆ é™¤ Keyã€Œ<strong id="deleteKeyName"></strong>ã€å—ï¼Ÿ<br />
          <span style="color: #ef4444;">æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œä½¿ç”¨æ­¤ Key çš„åº”ç”¨å°†æ— æ³•è®¿é—®ã€‚</span>
        </p>
        <input type="hidden" id="deleteKeyId" />
        <div style="display: flex; gap: 8px;">
          <button class="btn" style="flex: 1; background: rgba(255,255,255,0.1); color: white;"
            onclick="closeDeleteKeyModal()">
            å–æ¶ˆ
          </button>
          <button class="btn btn-danger" style="flex: 1;" onclick="confirmDeleteKey()">
            åˆ é™¤
          </button>
        </div>
      </div>
    </div>

    <!-- Toast å®¹å™¨ -->
    <div class="toast-container" id="toastContainer"></div>

    <div class="modal" id="accountModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="modalTitle">æ·»åŠ è´¦å·</h3>
          <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>
        <form id="accountForm" onsubmit="saveAccount(event)">
          <input type="hidden" id="accountId" />
          <div class="form-group">
            <label class="form-label">åç§°ï¼ˆå¯é€‰ï¼‰</label>
            <input type="text" class="form-input" id="name" placeholder="è´¦å·åç§°" />
          </div>
          <div class="form-group">
            <label class="form-label">è´¦å·ç±»å‹</label>
            <input type="text" class="form-input" id="accountType" placeholder="orchids" />
          </div>
          <div class="form-group">
            <label class="form-label">Token</label>
            <input type="text" class="form-input" id="clientCookie" required placeholder="ç²˜è´´ tokenï¼ˆæ”¯æŒå®Œæ•´Cookie/çº¯JWTï¼‰" />
            <small style="color: #666; font-size: 12px">æ”¯æŒå®Œæ•´Cookieï¼ˆå« __sessionï¼‰æˆ–çº¯JWTï¼›è¿è¡Œæ—¶è‡ªåŠ¨è·å–</small>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">æƒé‡</label>
              <input type="number" class="form-input" id="weight" value="1" min="1" />
            </div>
            <div class="form-group">
              <label class="form-label">Agent Mode</label>
              <input type="text" class="form-input" id="agentMode" value="claude-opus-4.5" />
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">
              <label class="toggle">
                <input type="checkbox" id="enabled" checked />
                <span class="toggle-slider"></span>
              </label>
              &nbsp;&nbsp;å¯ç”¨è´¦å·
            </label>
          </div>
          <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 16px">
            ä¿å­˜
          </button>
        </form>
      </div>
    </div>

    <script>
      let accounts = [];
      let currentPlatform = '';
      let accountHealth = {};
      let autoCheckTimer = null;
      let autoCheckRunning = false;
      let pageSize = 20;

      async function loadAccounts() {
        try {
          const res = await fetch("/api/accounts");
          if (res.status === 401) {
            window.location.href = "./login.html";
            return;
          }
          accounts = await res.json();
          renderPlatformTabs();
          renderAccounts();
          updateStats();
        } catch (err) {
          console.error("Failed to load accounts:", err);
          showToast("åŠ è½½è´¦å·å¤±è´¥", "error");
        }
      }

      function normalizeAccountType(acc) {
        return (acc.account_type || 'orchids').toLowerCase();
      }

      function renderPlatformTabs() {
        const container = document.getElementById("platformFilters");
        if (!container) return;
        const types = new Set(accounts.map(normalizeAccountType));
        const sorted = Array.from(types).sort();
        // Remove 'all' option
        const tabs = sorted;

        // Default to first tab if current is empty or invalid
        if ((currentPlatform === '' || currentPlatform === 'All') && tabs.length > 0) {
          currentPlatform = tabs[0];
          renderAccounts(); // Re-render to reflect the change
        }

        container.innerHTML = tabs.map(type => {
          const label = type;
          const active = currentPlatform === label;
          return `<button class="tab-item ${active ? 'active' : ''}" onclick="filterByPlatform('${label}')">${label}</button>`;
        }).join("");
      }

      function updateAccountHealth(id, ok, msg = '') {
        accountHealth[id] = {
          ok,
          msg,
          checkedAt: new Date().toISOString(),
        };
      }

      function statusBadge(acc) {
        const health = accountHealth[acc.id];
        if (health && !health.ok) {
          return { text: 'å¼‚å¸¸', color: '#fb7185', bg: 'rgba(251, 113, 133, 0.16)', tip: health.msg || 'æ£€æµ‹å¤±è´¥' };
        }
        if (!acc.enabled) {
          return { text: 'ç¦ç”¨', color: '#fb7185', bg: 'rgba(251, 113, 133, 0.16)', tip: 'è´¦å·å·²ç¦ç”¨' };
        }
        if (!acc.session_id && !acc.session_cookie) {
          return { text: 'å¾…è¡¥å…¨', color: '#f59e0b', bg: 'rgba(245, 158, 11, 0.16)', tip: 'ç¼ºå°‘ä¼šè¯ä¿¡æ¯' };
        }
        return { text: 'æ­£å¸¸', color: '#34d399', bg: 'rgba(52, 211, 153, 0.16)', tip: 'çŠ¶æ€æ­£å¸¸' };
      }

      async function checkAccount(id, silent = false) {
        try {
          const res = await fetch(`/api/accounts/${id}/refresh`);
          if (!res.ok) {
            throw new Error(await res.text());
          }
          const updated = await res.json();
          accounts = accounts.map(a => (a.id === id ? updated : a));
          updateAccountHealth(id, true);
          if (!silent) showToast(`è´¦å· ${updated.name || updated.email || id} æ­£å¸¸`, "success");
        } catch (err) {
          updateAccountHealth(id, false, err.message || String(err));
          if (!silent) showToast(`è´¦å· ${id} æ£€æµ‹å¤±è´¥`, "error");
        } finally {
          renderAccounts();
          updateStats();
        }
      }

      async function checkAllAccounts() {
        if (autoCheckRunning) return;
        if (!accounts.length) return;
        autoCheckRunning = true;
        showToast("å¼€å§‹æ£€æµ‹è´¦å·çŠ¶æ€", "info");
        for (const acc of accounts) {
          await checkAccount(acc.id, true);
        }
        showToast("è´¦å·æ£€æµ‹å®Œæˆ", "success");
        autoCheckRunning = false;
      }

      function toggleAutoCheck(enabled) {
        if (enabled) {
          if (autoCheckTimer) clearInterval(autoCheckTimer);
          autoCheckTimer = setInterval(checkAllAccounts, 10 * 60 * 1000);
          checkAllAccounts();
          showToast("å·²å¼€å¯è‡ªåŠ¨æ£€æµ‹", "success");
        } else {
          if (autoCheckTimer) clearInterval(autoCheckTimer);
          autoCheckTimer = null;
          showToast("å·²å…³é—­è‡ªåŠ¨æ£€æµ‹", "info");
        }
        localStorage.setItem("autoCheckEnabled", enabled ? "true" : "false");
      }

      async function deleteAllAccounts() {
        if (!accounts.length) return;
        if (!confirm(`ç¡®å®šè¦åˆ é™¤å…¨éƒ¨ ${accounts.length} ä¸ªè´¦å·å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`)) return;
        for (const acc of accounts) {
          await fetch(`/api/accounts/${acc.id}`, { method: "DELETE" });
        }
        await loadAccounts();
        showToast("å·²åˆ é™¤å…¨éƒ¨è´¦å·", "success");
      }

      function renderAccounts() {
        const container = document.getElementById("accountsList");
        const filtered = accounts.filter(acc => {
          if (!currentPlatform) return true;
          const key = currentPlatform.toLowerCase();
          return normalizeAccountType(acc).includes(key)
            || acc.agent_mode?.toLowerCase().includes(key)
            || acc.name?.toLowerCase().includes(key);
        });

        if (filtered.length === 0) {
          container.innerHTML = `
            <div class="empty-state" style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 300px; color: #94a3b8;">
              <span style="font-size: 3rem; margin-bottom: 16px;">ğŸ“‚</span>
              <p>æš‚æ—  ${currentPlatform} è´¦å·æ•°æ®</p>
            </div>`;
          document.getElementById("paginationInfo").textContent = `å…± 0 æ¡è®°å½•ï¼Œç¬¬ 1/1 é¡µ`;
          return;
        }

        container.innerHTML = `
                <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th style="width: 40px;"><input type="checkbox" onchange="toggleSelectAll(this.checked)"></th>
                            <th style="width: 60px;">ID</th>
                            <th>é‚®ç®±/åç§°</th>
                            <th>ç±»å‹</th>
                            <th>TOKEN</th>
                            <th>è®¢é˜…</th>
                            <th style="width: 180px;">ç”¨é‡</th>
                            <th>çŠ¶æ€</th>
                            <th>è°ƒç”¨</th>
                            <th>æœ€åè°ƒç”¨</th>
                            <th>é‡ç½®æ—¥æœŸ</th>
                            <th style="text-align: right;">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${filtered
            .map(
              (acc) => {
                const badge = statusBadge(acc);
                return `
                            <tr>
                                <td><input type="checkbox" class="row-checkbox" data-id="${acc.id}" onchange="updateSelectedCount()"></td>
                                <td style="color: #64748b; font-size: 0.9rem;">${acc.id}</td>
                                <td style="font-weight: 600; font-size: 0.95rem; color: #e2e8f0;">${escapeHtml(acc.email || acc.name || '-')}</td>
                                <td style="font-size: 0.9rem; color: #94a3b8;">${escapeHtml(acc.account_type || 'orchids')}</td>
                                <td>
                                    <span class="token-text" title="${escapeHtml(acc.token || '-')}">${escapeHtml(acc.token || (acc.session_id ? acc.session_id.substring(0, 20) + '...' : '-'))}</span>
                                </td>
                                <td><span class="tag tag-free">${acc.subscription || 'free'}</span></td>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <div class="usage-progress-container">
                                            <div class="usage-progress-bar ${acc.usage_current / (acc.usage_total || 550) > 0.8 ? 'red' : acc.usage_current / (acc.usage_total || 550) > 0.5 ? 'orange' : 'green'}" 
                                                 style="width: ${Math.min(100, (acc.usage_current / (acc.usage_total || 550)) * 100)}%;"></div>
                                        </div>
                                        <span style="font-size: 0.8rem; color: #64748b;">${(acc.usage_current || 0).toFixed(2)}/${acc.usage_total || 550}</span>
                                    </div>
                                </td>
                                <td>
                                    <span class="tag tag-status-normal" title="${escapeHtml(badge.tip)}" style="background: ${badge.bg}; color: ${badge.color}; border: none;">
                                        ${badge.text}
                                    </span>
                                </td>
                                <td style="font-size: 0.9rem; color: #e2e8f0; font-weight: 500;">${acc.request_count || 0}</td>
                                <td style="font-size: 0.8rem; color: #64748b;">${acc.last_used_at && !acc.last_used_at.startsWith('0001') ? formatTime(acc.last_used_at) : '-'}</td>
                                <td style="color: #64748b; font-size: 0.9rem;">${acc.reset_date || '-'}</td>
                                <td style="text-align: right;">
                                    <div style="display: flex; justify-content: flex-end; gap: 12px;">
                                        <i class="action-icon" onclick="refreshToken(${acc.id})" title="åˆ·æ–°">ğŸ”„</i>
                                        <i class="action-icon" onclick="deleteAccount(${acc.id})" title="åˆ é™¤">ğŸ—‘ï¸</i>
                                    </div>
                                </td>
                            </tr>
                        `;
              },
            )
            .join("")}
                    </tbody>
                </table>
                </div>
            `;

        document.getElementById("paginationInfo").textContent = `å…± ${filtered.length} æ¡è®°å½•ï¼Œç¬¬ 1/1 é¡µ`;
        updateSelectedCount();
      }

      function updateStats() {
        const total = accounts.length;
        const enabled = accounts.filter((a) => a.enabled).length;
        const abnormal = accounts.filter((a) => !a.enabled || (accountHealth[a.id] && !accountHealth[a.id].ok)).length;
        const disabled = abnormal;

        // Update cards
        document.getElementById("totalAccounts").textContent = total;
        document.getElementById("enabledAccounts").textContent = enabled;
        document.getElementById("disabledAccounts").textContent = disabled;

        // Update sidebar
        document.getElementById("footerTotal").textContent = total;
        document.getElementById("footerNormal").textContent = enabled;
        document.getElementById("footerAbnormal").textContent = disabled;

        // Update usage progress (mock)
        const usage = 4;
        const limit = 10000;
        const percent = (usage / limit) * 100;
        document.getElementById("usageProgress").style.width = percent + "%";
      }

      function updateSelectedCount() {
        const checked = document.querySelectorAll(".row-checkbox:checked").length;
        document.getElementById("selectedCount").textContent = checked;
        const batchBtn = document.getElementById("batchDeleteBtn");
        if (batchBtn) {
          batchBtn.disabled = checked === 0;
          batchBtn.style.color = checked === 0 ? "#94a3b8" : "#fb7185";
          batchBtn.style.borderColor = checked === 0 ? "rgba(148,163,184,0.2)" : "rgba(251,113,133,0.45)";
        }
      }

      function toggleSelectAll(checked) {
        document.querySelectorAll(".row-checkbox").forEach(cb => cb.checked = checked);
        updateSelectedCount();
      }

      function filterByPlatform(platform) {
        currentPlatform = platform === 'All' ? '' : platform;
        document.querySelectorAll("#platformFilters .tab-item").forEach(btn => {
          btn.classList.toggle("active", (currentPlatform === '' && btn.textContent === 'All') || btn.textContent === currentPlatform);
        });
        document.getElementById("pageSubtitle").textContent = currentPlatform ? `ç®¡ç†æ‚¨çš„ ${currentPlatform} API å‡­è¯` : "ç®¡ç†æ‚¨çš„æ‰€æœ‰ API å‡­è¯";
        renderAccounts();
      }

      function switchTab(tabName) {
        // Sidebar active state
        document.querySelectorAll(".sidebar-link").forEach(link => {
          link.classList.remove("active");
          if (link.getAttribute("onclick")?.includes(tabName)) {
            link.classList.add("active");
          }
        });

        const accountsWrapper = document.getElementById("accountsWrapper");
        const keysWrapper = document.getElementById("keysWrapper");
        const modelsWrapper = document.getElementById("modelsWrapper");
        const title = document.getElementById("pageTitle");

        if (tabName === 'accounts') {
          accountsWrapper.style.display = 'block';
          keysWrapper.style.display = 'none';
          modelsWrapper.style.display = 'none';
          document.getElementById("accountsHeader").style.display = 'block';
          document.getElementById("modelsHeader").style.display = 'none';
          title.textContent = "è´¦å·ç®¡ç†";
          loadAccounts();
        } else if (tabName === 'keys') {
          accountsWrapper.style.display = 'none';
          keysWrapper.style.display = 'block';
          modelsWrapper.style.display = 'none';
          document.getElementById("accountsHeader").style.display = 'none';
          document.getElementById("modelsHeader").style.display = 'none';
          title.textContent = "é…ç½®ç®¡ç†";
          loadConfiguration();
        } else if (tabName === 'models') {
          accountsWrapper.style.display = 'none';
          keysWrapper.style.display = 'none';
          modelsWrapper.style.display = 'block';
          document.getElementById("accountsHeader").style.display = 'none';
          document.getElementById("modelsHeader").style.display = 'block';
          title.textContent = "æ¨¡å‹ç®¡ç†";
          loadModels();
        } else if (tabName === 'qa') {
          accountsWrapper.style.display = 'none';
          keysWrapper.style.display = 'none';
          modelsWrapper.style.display = 'none';
          document.getElementById("qaWrapper").style.display = 'block';
          document.getElementById("accountsHeader").style.display = 'none';
          document.getElementById("modelsHeader").style.display = 'none';
          document.getElementById("qaHeader").style.display = 'block';
          title.textContent = "API è´¨é‡æµ‹è¯•";
        }

        localStorage.setItem("activeTab", tabName);
      }

      async function logout() {
        if (confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ")) {
          try {
            await fetch("/api/logout", { method: "POST" });
            window.location.href = "./login.html";
          } catch (err) {
            window.location.href = "./login.html";
          }
        }
      }

      async function clearAbnormalAccounts() {
        const abnormal = accounts.filter(a => !a.enabled);
        if (abnormal.length === 0) {
          showToast("æ²¡æœ‰å¼‚å¸¸è´¦å·", "info");
          return;
        }
        if (confirm(`ç¡®å®šè¦æ¸…ç©º ${abnormal.length} ä¸ªå¼‚å¸¸è´¦å·å—ï¼Ÿ`)) {
          for (const acc of abnormal) {
            await fetch(`/api/accounts/${acc.id}`, { method: "DELETE" });
          }
          loadAccounts();
          showToast("å·²æ¸…ç©ºå¼‚å¸¸è´¦å·");
        }
      }

      async function batchDeleteAccounts() {
        const selected = Array.from(document.querySelectorAll(".row-checkbox:checked")).map(cb => cb.dataset.id);
        if (selected.length === 0) return;
        if (confirm(`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${selected.length} ä¸ªè´¦å·å—ï¼Ÿ`)) {
          for (const id of selected) {
            await fetch(`/api/accounts/${id}`, { method: "DELETE" });
          }
          loadAccounts();
          showToast(`å·²æˆåŠŸåˆ é™¤ ${selected.length} ä¸ªè´¦å·`);
        }
      }

      function updatePageSize(size) {
        pageSize = parseInt(size);
        renderAccounts();
      }

      function openModal(account = null) {
        const modal = document.getElementById("accountModal");
        const title = document.getElementById("modalTitle");
        const form = document.getElementById("accountForm");

        if (account) {
          title.textContent = "ç¼–è¾‘è´¦å·";
          document.getElementById("accountId").value = account.id;
          document.getElementById("name").value = account.name;
          document.getElementById("accountType").value = account.account_type || "orchids";
          document.getElementById("clientCookie").value = account.client_cookie;
          document.getElementById("agentMode").value = account.agent_mode;
          document.getElementById("weight").value = account.weight;
          document.getElementById("enabled").checked = account.enabled;
        } else {
          title.textContent = "æ·»åŠ è´¦å·";
          form.reset();
          document.getElementById("accountId").value = "";
          document.getElementById("agentMode").value = "claude-opus-4.5";
          document.getElementById("weight").value = "1";
          document.getElementById("accountType").value = "orchids";
          document.getElementById("enabled").checked = true;
        }
        modal.classList.add("active");
        modal.style.display = "flex";
      }

      function closeModal() {
        const modal = document.getElementById("accountModal");
        modal.classList.remove("active");
        modal.style.display = "none";
      }

      async function saveAccount(e) {
        e.preventDefault();
        const id = document.getElementById("accountId").value;
        const data = {
          name: document.getElementById("name").value,
          account_type: document.getElementById("accountType").value,
          client_cookie: document.getElementById("clientCookie").value,
          agent_mode: document.getElementById("agentMode").value,
          weight: parseInt(document.getElementById("weight").value) || 1,
          enabled: document.getElementById("enabled").checked,
        };

        try {
          const url = id ? `/api/accounts/${id}` : "/api/accounts";
          const method = id ? "PUT" : "POST";
          const res = await fetch(url, {
            method,
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
          });
          if (!res.ok) throw new Error(await res.text());
          closeModal();
          loadAccounts();
          showToast("ä¿å­˜æˆåŠŸ");
        } catch (err) {
          showToast("ä¿å­˜å¤±è´¥: " + err.message, "error");
        }
      }

      function editAccount(id) {
        const account = accounts.find((a) => a.id === id);
        if (account) openModal(account);
      }

      async function refreshToken(id) {
        try {
          showToast("æ­£åœ¨æŸ¥è¯¢è´¦å·ä¿¡æ¯...", "info");
          const res = await fetch(`/api/accounts/${id}/refresh`);
          if (!res.ok) throw new Error(await res.text());
          const acc = await res.json();
          showToast(`è´¦å· ${acc.email} åˆ·æ–°å®Œæˆ`);
          loadAccounts(); // åˆ·æ–°åˆ—è¡¨
        } catch (err) {
          showToast("åˆ·æ–°å¤±è´¥: " + err.message, "error");
        }
      }

      async function deleteAccount(id) {
        if (!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè´¦å·å—ï¼Ÿ")) return;
        try {
          const res = await fetch(`/api/accounts/${id}`, { method: "DELETE" });
          if (!res.ok) throw new Error(await res.text());
          showToast("åˆ é™¤æˆåŠŸ");
          loadAccounts();
        } catch (err) {
          showToast("åˆ é™¤å¤±è´¥: " + err.message, "error");
        }
      }

      function escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement("div");
        div.textContent = text;
        return div.innerHTML;
      }

      function exportAccounts() {
        window.location.href = "/api/export";
      }

      async function importAccounts(event) {
        const file = event.target.files[0];
        if (!file) return;
        try {
          const text = await file.text();
          const res = await fetch("/api/import", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: text,
          });
          const result = await res.json();
          showToast(`å¯¼å…¥å®Œæˆ: æˆåŠŸ ${result.imported}, è·³è¿‡ ${result.skipped}`);
          loadAccounts();
        } catch (err) {
          showToast("å¯¼å…¥å¤±è´¥: " + err.message, "error");
        }
        event.target.value = "";
      }

      let apiKeys = [];
      let createdKeys = [];

      async function loadApiKeys() {
        try {
          const res = await fetch("/api/keys");
          if (res.status === 401) {
            window.location.href = "./login.html";
            return;
          }
          apiKeys = (await res.json()) || [];
          renderApiKeys();
        } catch (err) {
          showToast("åŠ è½½ API Keys å¤±è´¥", "error");
        }
      }

      function renderApiKeys() {
        const container = document.getElementById("keysList");
        if (apiKeys.length === 0) {
          container.innerHTML = '<div class="empty-state"><p>æš‚æ—  API Keyï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åˆ›å»º</p></div>';
          return;
        }
        container.innerHTML = `
          <table>
            <thead>
              <tr>
                <th>åç§°</th>
                <th>Key</th>
                <th>çŠ¶æ€</th>
                <th>æœ€åä½¿ç”¨</th>
                <th>æ“ä½œ</th>
              </tr>
            </thead>
            <tbody>
              ${apiKeys.map((k, idx) => `
                <tr>
                  <td style="font-weight: 600;">${escapeHtml(k.name)}</td>
                  <td>
                    <div style="display: flex; align-items: center; gap: 8px;">
                      <span style="cursor: pointer;" onclick="toggleKeyVisibility(${idx})">ğŸ‘ï¸</span>
                      <span id="key-display-${idx}" style="font-family: monospace; color: #64748b; cursor: pointer;" onclick="copyToClipboard('${k.key_full || k.key_prefix + '****' + k.key_suffix}')">
                        ${k.key_prefix}****...${k.key_suffix}
                      </span>
                    </div>
                  </td>
                  <td>
                    <label class="toggle" style="transform: scale(0.8);">
                      <input type="checkbox" ${k.enabled ? "checked" : ""} onchange="toggleKeyStatus(${k.id}, this.checked)">
                      <span class="toggle-slider"></span>
                    </label>
                  </td>
                  <td style="color: #94a3b8; font-size: 0.8rem;">${k.last_used_at ? formatTime(k.last_used_at) : "ä»æœªä½¿ç”¨"}</td>
                  <td>
                    <button class="btn btn-danger-outline" style="padding: 4px 8px;" onclick="openDeleteKeyModal(${k.id}, '${escapeHtml(k.name)}')">åˆ é™¤</button>
                  </td>
                </tr>
              `).join("")}
            </tbody>
          </table>`;
      }

      function toggleKeyVisibility(idx) {
        const span = document.getElementById(`key-display-${idx}`);
        const k = apiKeys[idx];
        if (span.textContent.includes('****')) {
          span.textContent = k.key_full || (k.key_prefix + '****' + k.key_suffix);
        } else {
          span.textContent = `${k.key_prefix}****...${k.key_suffix}`;
        }
      }

      async function toggleKeyStatus(id, enabled) {
        try {
          await fetch(`/api/keys/${id}`, {
            method: "PATCH",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ enabled }),
          });
          showToast(enabled ? "å·²å¯ç”¨" : "å·²ç¦ç”¨");
        } catch (err) {
          showToast("æ“ä½œå¤±è´¥", "error");
        }
      }

      function openCreateKeyModal() {
        document.getElementById("keyName").value = "";
        document.getElementById("createKeyModal").classList.add("active");
        document.getElementById("createKeyModal").style.display = "flex";
      }

      function closeCreateKeyModal() {
        document.getElementById("createKeyModal").classList.remove("active");
        document.getElementById("createKeyModal").style.display = "none";
      }

      async function createApiKey(e) {
        e.preventDefault();
        const names = document.getElementById("keyName").value.split("\n").filter(n => n.trim());
        if (names.length === 0) return;

        createdKeys = [];
        for (const name of names) {
          try {
            const res = await fetch("/api/keys", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ name }),
            });
            const data = await res.json();
            createdKeys.push({ name, key: data.key });
          } catch (err) {
            createdKeys.push({ name, error: err.message });
          }
        }
        closeCreateKeyModal();
        renderCreatedKeys();
        document.getElementById("showKeyModal").classList.add("active");
        document.getElementById("showKeyModal").style.display = "flex";
        loadApiKeys();
      }

      function renderCreatedKeys() {
        const container = document.getElementById("fullKeyDisplay");
        container.innerHTML = createdKeys.map(k => `
          <div class="key-display" style="margin-bottom: 8px; padding: 12px; background: #f8fafc; border: 1px dashed #cbd5e1; border-radius: 8px;">
            <div style="font-size: 0.8rem; color: #64748b;">${escapeHtml(k.name)}</div>
            <div style="font-weight: bold; margin-top: 4px; word-break: break-all; color: #22c55e;">${escapeHtml(k.key || k.error)}</div>
          </div>
        `).join("");
      }

      function closeShowKeyModal() {
        document.getElementById("showKeyModal").classList.remove("active");
        document.getElementById("showKeyModal").style.display = "none";
      }

      function openDeleteKeyModal(id, name) {
        document.getElementById("deleteKeyId").value = id;
        document.getElementById("deleteKeyName").textContent = name;
        const modal = document.getElementById("deleteKeyModal");
        modal.classList.add("active");
        modal.style.display = "flex";
      }

      function closeDeleteKeyModal() {
        const modal = document.getElementById("deleteKeyModal");
        modal.classList.remove("active");
        modal.style.display = "none";
      }

      async function confirmDeleteKey() {
        const id = document.getElementById("deleteKeyId").value;
        try {
          await fetch(`/api/keys/${id}`, { method: "DELETE" });
          closeDeleteKeyModal();
          showToast("åˆ é™¤æˆåŠŸ");
          loadApiKeys();
        } catch (err) {
          showToast("åˆ é™¤å¤±è´¥", "error");
        }
      }

      function formatTime(iso) {
        const d = new Date(iso);
        const now = new Date();
        const diff = (now - d) / 1000;
        if (diff < 60) return "åˆšåˆš";
        if (diff < 3600) return Math.floor(diff / 60) + " åˆ†é’Ÿå‰";
        if (diff < 86400) return Math.floor(diff / 3600) + " å°æ—¶å‰";
        return d.toLocaleDateString();
      }

      function showToast(msg, type = 'success') {
        const container = document.getElementById("toastContainer");
        const toast = document.createElement("div");
        toast.className = `toast`;
        const color = type === 'success' ? '#34d399' : type === 'info' ? '#38bdf8' : '#fb7185';
        const icon = type === 'success' ? 'âœ…' : type === 'info' ? 'â„¹ï¸' : 'âŒ';
        toast.style.borderLeft = `4px solid ${color}`;
        toast.innerHTML = `<span>${icon}</span> ${msg}`;
        container.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
      }

      async function copyToClipboard(text) {
        try {
          if (navigator.clipboard && window.isSecureContext) {
            await navigator.clipboard.writeText(text);
          } else {
            const el = document.createElement('textarea');
            el.value = text;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
          }
          showToast("å·²å¤åˆ¶åˆ°å‰ªåˆ‡æ¿");
        } catch (err) {
          showToast("å¤åˆ¶å¤±è´¥", "error");
        }
      }

      function switchConfigTab(tab) {
        document.querySelectorAll("#configTabs .tab-item").forEach(btn => {
          btn.classList.toggle("active", btn.textContent.includes(tab === 'basic' ? 'åŸºç¡€' : tab === 'auth' ? 'æˆæƒ' : 'ä»£ç†'));
        });
        document.getElementById("basicConfig").style.display = tab === 'basic' ? 'block' : 'none';
        document.getElementById("authConfig").style.display = tab === 'auth' ? 'block' : 'none';
        document.getElementById("proxyConfig").style.display = tab === 'proxy' ? 'block' : 'none';

        if (tab === 'auth') loadApiKeys();
      }

      function updateSwitchLabel(el, text) {
        const span = document.getElementById("label_" + el.id);
        if (span) {
          span.textContent = text + (el.checked ? " (å·²å¼€å¯)" : " (å·²å…³é—­)");
        }
      }

      async function loadConfiguration() {
        try {
          const res = await fetch("/api/config");
          if (res.status === 401) {
            window.location.href = "./login.html";
            return;
          }
          const cfg = await res.json();

          document.getElementById("cfg_admin_pass").value = cfg.admin_pass || "";
          document.getElementById("cfg_admin_token").value = cfg.admin_token || "";
          document.getElementById("cfg_max_retries").value = cfg.max_retries || 3;
          document.getElementById("cfg_retry_delay").value = cfg.retry_delay || 1000;
          document.getElementById("cfg_switch_count").value = cfg.account_switch_count || 5;
          document.getElementById("cfg_request_timeout").value = cfg.request_timeout || 120;
          document.getElementById("cfg_request_timeout").value = cfg.request_timeout || 120;
          document.getElementById("cfg_refresh_interval").value = cfg.token_refresh_interval || 30;

          // Proxy Config Loading
          document.getElementById("cfg_proxy_http").value = cfg.proxy_http || "";
          document.getElementById("cfg_proxy_https").value = cfg.proxy_https || "";
          document.getElementById("cfg_proxy_user").value = cfg.proxy_user || "";
          document.getElementById("cfg_proxy_pass").value = cfg.proxy_pass || "";
          document.getElementById("cfg_proxy_bypass").value = (cfg.proxy_bypass || []).join("\n");

          const autoToken = document.getElementById("cfg_auto_refresh_token");
          autoToken.checked = cfg.auto_refresh_token || false;
          updateSwitchLabel(autoToken, "è‡ªåŠ¨åˆ·æ–°Token");

          const autoUsage = document.getElementById("cfg_auto_refresh_usage");
          autoUsage.checked = cfg.auto_refresh_usage || false;
          updateSwitchLabel(autoUsage, "è‡ªåŠ¨åˆ·æ–°ç”¨é‡");

          document.getElementById("cfg_output_token_count").checked = cfg.output_token_count || false;
          document.getElementById("cfg_cache_token_count").checked = cfg.cache_token_count || false;
          document.getElementById("cfg_cache_ttl").value = cfg.cache_ttl || 5;
          document.getElementById("cfg_cache_strategy").value = cfg.cache_strategy || "split";

        } catch (err) {
          showToast("åŠ è½½é…ç½®å¤±è´¥", "error");
        }
      }

      async function saveConfiguration() {
        const data = {
          admin_pass: document.getElementById("cfg_admin_pass").value,
          admin_token: document.getElementById("cfg_admin_token").value,
          max_retries: parseInt(document.getElementById("cfg_max_retries").value),
          retry_delay: parseInt(document.getElementById("cfg_retry_delay").value),
          account_switch_count: parseInt(document.getElementById("cfg_switch_count").value),
          request_timeout: parseInt(document.getElementById("cfg_request_timeout").value),
          token_refresh_interval: parseInt(document.getElementById("cfg_refresh_interval").value),
          auto_refresh_token: document.getElementById("cfg_auto_refresh_token").checked,
          auto_refresh_usage: document.getElementById("cfg_auto_refresh_usage").checked,
          output_token_count: document.getElementById("cfg_output_token_count").checked,
          cache_token_count: document.getElementById("cfg_cache_token_count").checked,
          cache_ttl: parseInt(document.getElementById("cfg_cache_ttl").value),
          cache_token_count: document.getElementById("cfg_cache_token_count").checked,
          cache_ttl: parseInt(document.getElementById("cfg_cache_ttl").value),
          cache_strategy: document.getElementById("cfg_cache_strategy").value,

          // Proxy Config Saving
          proxy_http: document.getElementById("cfg_proxy_http").value,
          proxy_https: document.getElementById("cfg_proxy_https").value,
          proxy_user: document.getElementById("cfg_proxy_user").value,
          proxy_pass: document.getElementById("cfg_proxy_pass").value,
          proxy_bypass: document.getElementById("cfg_proxy_bypass").value.split("\n").filter(line => line.trim() !== "")
        };

        try {
          const res = await fetch("/api/config", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
          });
          if (!res.ok) throw new Error(await res.text());
          showToast("é…ç½®å·²ä¿å­˜");
        } catch (err) {
          showToast("ä¿å­˜å¤±è´¥: " + err.message, "error");
        }
      }

      function togglePassword(id) {
        const input = document.getElementById(id);
        input.type = input.type === 'password' ? 'text' : 'password';
      }

      function copyFieldValue(id) {
        const val = document.getElementById(id).value;
        if (!val) {
          showToast("æ²¡æœ‰å†…å®¹å¯å¤åˆ¶", "info");
          return;
        }
        copyToClipboard(val);
      }

      // Model Management Logic
      let models = [];
      let currentModelChannel = '';

      async function loadModels() {
        try {
          const res = await fetch("/api/models");
          if (res.status === 401) {
            window.location.href = "./login.html";
            return;
          }
          models = await res.json() || [];
          renderModels();
        } catch (err) {
          showToast("åŠ è½½æ¨¡å‹å¤±è´¥", "error");
        }
      }

      function renderModels() {
        const container = document.getElementById("modelsList");
        let filtered = models;
        if (currentModelChannel) {
          filtered = models.filter(m => m.channel.toLowerCase() === currentModelChannel.toLowerCase());
        }

        // Sort: SortOrder ascending
        filtered.sort((a, b) => {
          return a.sort_order - b.sort_order;
        });

        document.getElementById("totalModelCount").textContent = filtered.length;

        if (filtered.length === 0) {
          container.innerHTML = `
            <div class="empty-state" style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 300px; color: #94a3b8;">
              <span style="font-size: 3rem; margin-bottom: 16px;">ğŸ’</span>
              <p>æš‚æ— ${currentModelChannel ? ' ' + currentModelChannel : ''} æ¨¡å‹æ•°æ®</p>
            </div>`;
          return;
        }

        container.innerHTML = `
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th style="width: 60px;">ID</th>
                  <th>æ¸ é“</th>
                  <th>æ¨¡å‹ID</th>
                  <th>æ¨¡å‹åç§°</th>
                  <th>çŠ¶æ€</th>
                  <th>é»˜è®¤</th>
                  <th>æ’åº</th>
                  <th style="text-align: right;">æ“ä½œ</th>
                </tr>
              </thead>
              <tbody>
                ${filtered.map(m => `
                  <tr>
                    <td style="color: #64748b; font-size: 0.9rem;">${m.id}</td>
                    <td><span class="tag badge-${m.channel.toLowerCase()}">${escapeHtml(m.channel)}</span></td>
                    <td style="font-family: monospace; color: #94a3b8;">${escapeHtml(m.model_id)}</td>
                    <td style="font-weight: 500; color: #e2e8f0;">${escapeHtml(m.name)}</td>
                    <td>
                      <span class="status-badge status-enabled">
                        ${m.status === 'available' || m.status === true ? 'å¯ç”¨' : 'ç¦ç”¨'}
                      </span>
                    </td>
                    <td style="text-align: center;">
                      ${m.is_default ? '<span class="default-check">âœ…</span>' : '-'}
                    </td>
                    <td>${m.sort_order}</td>
                    <td style="text-align: right;">
                      <div style="display: flex; justify-content: flex-end; align-items: center; gap: 12px;">
                        <i class="action-icon" style="font-size: 1.2rem;" onclick="editModel('${m.id}')" title="ç¼–è¾‘">ğŸ“‹</i>
                        ${!m.is_default ? `<a class="set-default-link" onclick="setDefaultModel('${m.id}')">è®¾ä¸ºé»˜è®¤</a>` : ''}
                        <i class="action-icon" style="font-size: 1.2rem;" onclick="deleteModel('${m.id}')" title="åˆ é™¤">ğŸ—‘ï¸</i>
                      </div>
                    </td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          </div>
        `;
      }

      async function setDefaultModel(id) {
        const model = models.find(m => m.id === id);
        if (!model) return;

        try {
          // Updated logic to clear other defaults for same channel
          const updatedModel = { ...model, is_default: true };
          const res = await fetch(`/api/models/${id}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(updatedModel),
          });
          if (!res.ok) throw new Error(await res.text());

          showToast("è®¾ä¸ºé»˜è®¤æˆåŠŸ");
          loadModels();
        } catch (err) {
          showToast("è®¾ç½®å¤±è´¥: " + err.message, "error");
        }
      }

      function filterModelsByChannel(channel) {
        currentModelChannel = channel;
        document.querySelectorAll("#modelPlatformFilters .tab-item").forEach(btn => {
          btn.classList.toggle("active", (channel === '' && btn.textContent === 'All') || btn.textContent === channel);
        });
        renderModels();
      }

      function openModelModal(model = null) {
        const modal = document.getElementById("modelModal");
        const title = document.getElementById("modelModalTitle");
        const form = document.getElementById("modelForm");

        if (model) {
          title.textContent = "ç¼–è¾‘æ¨¡å‹";
          document.getElementById("modelId").value = model.id;
          document.getElementById("modelChannel").value = model.channel;
          document.getElementById("modelModelId").value = model.model_id;
          document.getElementById("modelName").value = model.name;
          document.getElementById("modelSortOrder").value = model.sort_order;
          document.getElementById("modelStatus").value = model.status;
          document.getElementById("modelIsDefault").checked = model.is_default;
        } else {
          title.textContent = "æ·»åŠ æ¨¡å‹";
          form.reset();
          document.getElementById("modelId").value = "";
          document.getElementById("modelChannel").value = "Orchids";
          document.getElementById("modelSortOrder").value = "0";
          document.getElementById("modelStatus").value = "available";
        }
        modal.classList.add("active");
        modal.style.display = "flex";
      }

      function closeModelModal() {
        const modal = document.getElementById("modelModal");
        modal.classList.remove("active");
        modal.style.display = "none";
      }

      async function saveModel(e) {
        e.preventDefault();
        const id = document.getElementById("modelId").value;
        const data = {
          channel: document.getElementById("modelChannel").value,
          model_id: document.getElementById("modelModelId").value,
          name: document.getElementById("modelName").value,
          sort_order: parseInt(document.getElementById("modelSortOrder").value) || 0,
          status: document.getElementById("modelStatus").value,
          is_default: document.getElementById("modelIsDefault").checked
        };

        if (id) {
          data.id = id;
        }

        try {
          const url = id ? `/api/models/${id}` : "/api/models";
          const method = id ? "PUT" : "POST";
          const res = await fetch(url, {
            method,
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
          });
          if (!res.ok) throw new Error(await res.text());
          closeModelModal();
          loadModels();
          showToast("ä¿å­˜æˆåŠŸ");
        } catch (err) {
          showToast("ä¿å­˜å¤±è´¥: " + err.message, "error");
        }
      }

      function editModel(id) {
        const model = models.find(m => m.id === id);
        if (model) openModelModal(model);
      }

      async function deleteModel(id) {
        if (!confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ¨¡å‹å—ï¼Ÿ")) return;
        try {
          const res = await fetch(`/api/models/${id}`, { method: "DELETE" });
          if (!res.ok) throw new Error(await res.text());
          showToast("åˆ é™¤æˆåŠŸ");
          loadModels();
        } catch (err) {
          showToast("åˆ é™¤å¤±è´¥: " + err.message, "error");
        }
      }

      async function refreshModels() {
        if (!confirm("ç¡®å®šè¦ä»ä¸Šæ¸¸åˆ·æ–°æ¨¡å‹åˆ—è¡¨å—ï¼Ÿ")) return;
        try {
          showToast("æ­£åœ¨æŸ¥è¯¢ä¸Šæ¸¸æ¨¡å‹...", "info");
          const res = await fetch("/api/models/refresh", { method: "POST" });
          if (!res.ok) throw new Error(await res.text());
          const result = await res.json();
          showToast(`åŒæ­¥æˆåŠŸ: æ›´æ–°äº† ${result.count} ä¸ªæ¨¡å‹`);
          loadModels();
        } catch (err) {
          showToast("åŒæ­¥å¤±è´¥: " + err.message, "error");
        }
      }

      // QA Logic
      const qaTestCases = {
        greeting: "Hello, say hi locally.",
        math: "Calculate 25 * 42 step by step.",
        tool_ls: "List the files in the current directory.",
        tool_calc: "Use the calculator to find 123 * 456.",
        mega_context: "generate", // Special flag
        custom: ""
      };

      function loadQaPrompt() {
        const key = document.getElementById("qaTestCase").value;
        if (key === 'custom') {
          return;
        }
        if (key === 'mega_context') {
          const base = "This is a line of text to simulate context. ";
          let result = "Ignore the following repeated context and just tell me the specific count of the word 'context'.\n\n";
          // Generate approx 50k tokens (1 token ~ 4 chars). 50k * 4 = 200k chars.
          // base length ~ 40 chars. 200000 / 40 = 5000 lines.
          for (let i = 0; i < 5000; i++) {
            result += `${i + 1}. ${base}\n`;
          }
          result += "\n\nEnd of context. How many times does the word 'context' appear in the numbered list above?";
          document.getElementById("qaInput").value = result;
        } else {
          document.getElementById("qaInput").value = qaTestCases[key];
        }
      }

      async function runQaTest() {
        const input = document.getElementById("qaInput").value;
        const model = document.getElementById("qaModel").value;
        const outputDiv = document.getElementById("qaOutput");
        const btn = document.getElementById("qaRunBtn");

        outputDiv.innerHTML = '<span style="color: #94a3b8;">Connecting...</span>';
        btn.disabled = true;

        try {
          const res = await fetch("/v1/messages", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              model: model,
              messages: [{ role: "user", content: input }],
              stream: true
            })
          });

          if (!res.ok) {
            outputDiv.innerHTML = `<span style="color: #ef4444;">Error: ${res.status} ${res.statusText}</span>\n${await res.text()}`;
            btn.disabled = false;
            return;
          }

          outputDiv.innerHTML = ""; // Clear
          const reader = res.body.getReader();
          const decoder = new TextDecoder();

          while (true) {
            const { done, value } = await reader.read();
            if (done) break;
            const chunk = decoder.decode(value, { stream: true });
            const lines = chunk.split('\n');

            for (const line of lines) {
              if (line.startsWith("data: ")) {
                const dataStr = line.slice(6);
                if (dataStr === "[DONE]") continue;
                try {
                  const event = JSON.parse(dataStr);
                  handleQaEvent(event, outputDiv);
                } catch (e) {
                  // ignore json parse error for partial lines
                }
              }
            }
          }
          outputDiv.innerHTML += `\n<span style="color: #10b981;">[DONE]</span>`;

        } catch (err) {
          outputDiv.innerHTML += `\n<span style="color: #ef4444;">Request Failed: ${err.message}</span>`;
        } finally {
          btn.disabled = false;
        }
      }

      function handleQaEvent(event, container) {
        if (event.type === 'message_start') {
          // init
        } else if (event.type === 'content_block_start') {
          const block = event.content_block;
          if (block.type === 'thinking') {
            container.innerHTML += `<span style="color: #6366f1;">[THINKING START]</span>\n`;
          } else if (block.type === 'tool_use') {
            container.innerHTML += `<span style="color: #f59e0b;">[TOOL USE: ${block.name}]</span>\n`;
          }
        } else if (event.type === 'content_block_delta') {
          const delta = event.delta;
          if (delta.type === 'text_delta') {
            container.textContent += delta.text; // Use textContent to append text safely, but wait, innerHTML is used above.
            // Better strictly append text node or use innerHTML with escaping if we want colors. 
            // Ideally we should separate structure from content. 
            // For simplicity, let's just append text.
            // Actually, mixing innerHTML and textContent is tricky. Let's append spans.
            const span = document.createElement('span');
            span.textContent = delta.text;
            container.appendChild(span);
            container.scrollTop = container.scrollHeight;
          } else if (delta.type === 'thinking_delta') {
            const span = document.createElement('span');
            span.style.color = '#818cf8';
            span.textContent = delta.thinking;
            container.appendChild(span);
            container.scrollTop = container.scrollHeight;
          }
        } else if (event.type === 'content_block_stop') {
          // block end
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        const savedTab = localStorage.getItem("activeTab") || "accounts";
        switchTab(savedTab);
        const autoCheckEnabled = localStorage.getItem("autoCheckEnabled") === "true";
        const autoToggle = document.getElementById("autoCheckToggle");
        if (autoToggle) {
          autoToggle.checked = autoCheckEnabled;
          if (autoCheckEnabled) {
            toggleAutoCheck(true);
          }
        }
      });
    </script>
</body>

</html>